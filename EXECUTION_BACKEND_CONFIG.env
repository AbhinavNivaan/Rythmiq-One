################################################################################
# Execution Backend Deployment Configuration
# Environment variable templates for each supported backend
################################################################################

# ============================================================================
# LOCAL BACKEND (Development / Testing)
# ============================================================================
# No additional setup required. Jobs run on the local machine using CpuWorker.
#
# .env.local:
# -----------
EXECUTION_BACKEND=local

# ============================================================================
# CAMBER BACKEND (External Execution Engine)
# ============================================================================
# Delegates job execution to Camber Cloud.
#
# Required Credentials:
#   - Camber API Key (obtain from Camber dashboard)
#
# .env.camber:
# -----------
EXECUTION_BACKEND=camber
CAMBER_API_KEY=sk-your-camber-api-key-here
CAMBER_API_ENDPOINT=https://api.camber.cloud
CAMBER_EXECUTION_REGION=us-east-1
CAMBER_QUEUE_NAME=default
CAMBER_EXECUTION_TIMEOUT_MS=300000

# ============================================================================
# DIGITALOCEAN BACKEND (App Platform)
# ============================================================================
# Delegates job execution to DigitalOcean Apps or Functions.
#
# Required Credentials:
#   - DigitalOcean API Token (create in Account > API > Tokens)
#
# Deployment Steps:
#   1. Create personal access token in DigitalOcean console
#   2. Create app.yaml (see Dockerfile for spec)
#   3. Deploy with: doctl apps create --spec app.yaml
#   4. Set environment variables via console or CLI:
#      doctl apps update <app-id> --spec app.yaml
#   5. Monitor: doctl apps logs <app-id> --follow
#
# .env.do:
# --------
EXECUTION_BACKEND=do
DO_API_TOKEN=dop_v1_your_digitalocean_api_token_here
DO_API_ENDPOINT=https://api.digitalocean.com/v2
DO_APP_NAME=rythmiq-execution
DO_EXECUTION_REGION=nyc
DO_FUNCTION_MEMORY_MB=256
DO_EXECUTION_TIMEOUT_MS=300000

# ============================================================================
# HEROKU BACKEND (Dynos / Worker Process)
# ============================================================================
# Delegates job execution to Heroku dynos (web, worker, scheduler).
#
# Required Credentials:
#   - Heroku API Key (create in Account Settings > API Keys)
#   - Heroku App Name (create with: heroku create app-name)
#
# Deployment Steps:
#   1. Create Heroku account and CLI
#   2. Create app: heroku create rythmiq-execution
#   3. Add Procfile to repo root (see below)
#   4. Deploy: git push heroku main
#   5. Set environment variables:
#      heroku config:set EXECUTION_BACKEND=heroku \
#                       HEROKU_API_KEY=<token> \
#                       HEROKU_DYNO_SIZE=standard-1x \
#                       -a rythmiq-execution
#   6. Scale workers: heroku ps:scale worker=2 -a rythmiq-execution
#   7. View logs: heroku logs --tail -a rythmiq-execution
#
# .env.heroku:
# -----------
EXECUTION_BACKEND=heroku
HEROKU_API_KEY=hrku_your_heroku_api_key_here
HEROKU_API_ENDPOINT=https://api.heroku.com
HEROKU_APP_NAME=rythmiq-execution
HEROKU_DYNO_TYPE=worker
HEROKU_DYNO_SIZE=standard-1x
HEROKU_EXECUTION_TIMEOUT_MS=300000

# ============================================================================
# HEROKU PROCFILE (required in repo root)
# ============================================================================
# web: npm run start
# worker: npm run worker
#

# ============================================================================
# COMMON ENVIRONMENT VARIABLES (All backends)
# ============================================================================
# These are available for all execution backends
# Adjust as needed for your deployment

NODE_ENV=production
LOG_LEVEL=info

# ============================================================================
# LOADING ENVIRONMENT VARIABLES
# ============================================================================
#
# Node.js / Express:
#   npm install dotenv
#
#   At app startup (before any backend selection):
#   require('dotenv').config();
#   const { selectExecutionBackend } = require('./bootstrap/executionSelector');
#   const backend = selectExecutionBackend(deps);
#
# TypeScript (with ts-node):
#   Add to tsconfig.json:
#   "ts-node": {
#     "require": ["dotenv/config"]
#   }
#
# Docker:
#   docker run -e EXECUTION_BACKEND=local image-name
#   docker run --env-file .env.do image-name
#
# Docker Compose:
#   version: '3'
#   services:
#     execution:
#       image: rythmiq-execution:latest
#       env_file: .env.do
#       ports:
#         - "3000:3000"
#
# Kubernetes:
#   kubectl create secret generic execution-secrets \
#     --from-env-file=.env.do
#
#   In deployment.yaml:
#   spec:
#     containers:
#     - name: execution
#       env:
#       - name: EXECUTION_BACKEND
#         value: "do"
#       - name: DO_API_TOKEN
#         valueFrom:
#           secretKeyRef:
#             name: execution-secrets
#             key: DO_API_TOKEN
#

# ============================================================================
# VERIFICATION STEPS
# ============================================================================
#
# After setting up environment variables, verify backend selection:
#
# Local bash:
#   EXECUTION_BACKEND=camber node -e "console.log(require('./bootstrap/executionSelector').getSelectedBackendType())"
#
# Docker:
#   docker run -e EXECUTION_BACKEND=heroku my-image node -e "console.log(require('./bootstrap/executionSelector').getSelectedBackendType())"
#
# Application startup logs should indicate selected backend:
#   INFO: ExecutionBackend selected: camber
#   INFO: Initializing CamberExecutionBackend
#   INFO: Camber API configured at https://api.camber.cloud
#

